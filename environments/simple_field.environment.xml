<variable name="NUM_TILTED_BEAMS_X" value="21"></variable>
<variable name="NUM_TILTED_BEAMS_Y" value="10"></variable>

<variable name="NUM_CORRIDORS_X" value="10"></variable>

<variable name="NUM_PLANTS_CORRIDOR_SOUTH" value="8"></variable>
<variable name="NUM_PLANTS_CORRIDOR_NORTH" value="12"></variable>

<variable name="NUM_POLES_X" value="10"></variable>
<variable name="NUM_POLES_Y" value="10"></variable>

<variable name="PLANTS_RAND_XY" value="0.35"></variable>

<variable name="CEILING_HEIGHT" value="3.0"></variable>

<!-- ========================
		Scenario definition
		======================== -->
<!-- ground -->
<element class="horizontal_plane">
	<cull_face>BACK</cull_face>
	<x_min>0</x_min>  <y_min>0</y_min>
	<x_max>46</x_max> <y_max>28.6</y_max>
	<z>0.0</z>
	<!-- <texture>https://mrpt.github.io/mvsim-models/textures-cgbookcase/Dirt01_512_BaseColor.png</texture> -->
	<!-- <texture_size_x>1.5</texture_size_x> -->
	<!-- <texture_size_y>1.5</texture_size_y> -->
</element>



<!-- ======================================
		Object types
		====================================== -->
<block:class name="pole_tilted">
	<static>true</static> <!-- Does not move -->
	<shape_from_visual/> <!-- automatic shape,zmin,zmax from 3D mesh-->
	<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
	<visual>
		<model_uri>./pole_tilted_he120e.stl</model_uri>
		<model_offset_z>1.2</model_offset_z>
		<model_roll>90.0</model_roll>
	</visual>
</block:class>

<block:class name="pole_009">
	<static>true</static> <!-- Does not move -->
	<shape_from_visual/> <!-- automatic shape,zmin,zmax from 3D mesh-->
	<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
	<visual>
		<model_uri>${MVSIM_CURRENT_FILE_DIRECTORY}/pole_009.stl</model_uri>
		<model_offset_z>1.2</model_offset_z>
	</visual>
</block:class>

<block:class name="pole_004">
	<static>true</static> <!-- Does not move -->
	<shape_from_visual/> <!-- automatic shape,zmin,zmax from 3D mesh-->
	<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
	<visual>
		<model_uri>${MVSIM_CURRENT_FILE_DIRECTORY}/pole_004.stl</model_uri>
		<model_offset_z>1.2</model_offset_z>
	</visual>
</block:class>

<block:class name="plant_tomato">
	<static>true</static> <!-- Does not move -->
	<mass>5</mass>
	<shape_from_visual/> <!-- automatic shape,zmin,zmax from 3D mesh-->
	<!--  Custom visualization model. 3D model filename to load (local or remote http://uri ) -->
	<visual>
		<model_uri>${MVSIM_CURRENT_FILE_DIRECTORY}/tomato_plant_240cm.dae</model_uri>
		<model_roll>90.0</model_roll>
		<model_offset_z>-0.05</model_offset_z>
	</visual>
</block:class>

<!-- ======================================
		Object instances
		====================================== -->
<!-- You can assign an optional custom name to each object, as an attribute to block, like name="shelf_001", etc. -->

<!-- All coordinates are global coords:
		SE(2) <init_pose>x y yaw(deg)</init_pose> or
		SE(3) <init_pose3d>x y z yaw(deg) pitch(deg) roll(deg)</init_pose3d>
-->

<!-- H-beams along the X axis -->
<for var="iX" from="0" to="$f{NUM_TILTED_BEAMS_X-1}">
	<block class="pole_tilted">
		<init_pose>$f{3.95+2*iX} 1.35 180</init_pose>
	</block>
	<block class="pole_tilted">
		<init_pose>$f{3.95+2*iX} $f{28.6-1.35} 0</init_pose>
	</block>
</for>

<!-- H-beams along the Y axis -->
<for var="iY" from="0" to="$f{NUM_TILTED_BEAMS_Y-1}">
	<block class="pole_tilted">
		<init_pose>1.30 $f{3.9+2*iY} 90</init_pose>
	</block>
	<block class="pole_tilted">
		<init_pose>$f{46-1.30} $f{3.9+2*iY} -90</init_pose>
	</block>
</for>

<!-- Thick poles -->
<for var="iX" from="0" to="4">
	<for var="iY" from="0" to="10">
		<if condition="$f{if(iY<=3 or iY>=6, 1, 0)}">
			<block class="pole_009">
				<init_pose>$f{4+8*iX} $f{3.9+2*iY} 0</init_pose>
			</block>
		</if>
	</for>
</for>

<!-- Thin poles -->
<for var="iX" from="0" to="4">
	<for var="iY" from="0" to="10">
		<if condition="$f{if(iY<=3 or iY>=6, 1, 0)}">
			<block class="pole_004">
				<init_pose>$f{4+4+8*iX} $f{3.9+2*iY} 0</init_pose>
			</block>
		</if>
	</for>
</for>


<!-- Plants -->
<for var="iX" from="0" to="$f{NUM_CORRIDORS_X-1}">
	<for var="iY" from="0" to="$f{NUM_PLANTS_CORRIDOR_SOUTH-1}">
		<block class="plant_tomato">
			<init_pose>$f{3.95+4*iX+rand()*PLANTS_RAND_XY} $f{3.0+iY*(9/NUM_PLANTS_CORRIDOR_SOUTH)+rand()*PLANTS_RAND_XY} $f{rand()*360}</init_pose>
		</block>
		<block class="plant_tomato">
			<init_pose>$f{3.95+4*iX+3.0+rand()*PLANTS_RAND_XY} $f{3.0+iY*(9/NUM_PLANTS_CORRIDOR_SOUTH)+rand()*PLANTS_RAND_XY} $f{rand()*360}</init_pose>
		</block>
	</for>
	<for var="iY" from="0" to="$f{NUM_PLANTS_CORRIDOR_NORTH-1}">
		<block class="plant_tomato">
			<init_pose>$f{3.95+4*iX+rand()*PLANTS_RAND_XY} $f{15.0+iY*(12/NUM_PLANTS_CORRIDOR_NORTH)+rand()*PLANTS_RAND_XY} $f{rand()*360}</init_pose>
		</block>
		<block class="plant_tomato">
			<init_pose>$f{3.95+4*iX+3.0+rand()*PLANTS_RAND_XY} $f{15.0+iY*(12/NUM_PLANTS_CORRIDOR_NORTH)+rand()*PLANTS_RAND_XY} $f{rand()*360}</init_pose>
		</block>
	</for>
</for>

